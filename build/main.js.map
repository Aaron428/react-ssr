{"version":3,"sources":["webpack://server/./src/components/Header.js","webpack://server/./src/containers/Home/index.js","webpack://server/./src/containers/Home/store/actions.js","webpack://server/./src/containers/Home/store/constants.js","webpack://server/./src/containers/Home/store/index.js","webpack://server/./src/containers/Home/store/reducer.js","webpack://server/./src/containers/Login/index.js","webpack://server/./src/routes.js","webpack://server/./src/server/utils.js","webpack://server/./src/store/index.js","webpack://server/external \"axios\"","webpack://server/external \"express\"","webpack://server/external \"react\"","webpack://server/external \"react-dom/server\"","webpack://server/external \"react-redux\"","webpack://server/external \"react-router-dom\"","webpack://server/external \"redux\"","webpack://server/external \"redux-thunk\"","webpack://server/webpack/bootstrap","webpack://server/./src/server/index.js"],"names":["Header","marginRight","Home","props","newList","length","getHomeList","name","alert","map","news","id","title","React","Component","loadData","store","dispatch","mapStateToProps","state","home","mapDispatchToProps","changeHomeList","type","CHANGE_HOME_LIST","getHomeListAction","axios","get","then","res","status","list","data","reducer","defaultState","action","Login","key","path","exact","component","render","routes","homeString","route","JSON","stringify","getState","homeReducer","getStore","thunk","getClientStore","window","context","app","port","use","express","static","req","matchedRoutes","promises","some","match","push","forEach","item","Promise","all","html","send","listen","console","log"],"mappings":"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","file":"main.js","sourcesContent":["import React from 'react';\nimport {Link} from 'react-router-dom';\n\nconst Header = () => (\n  <div>\n    <Link to=\"/\" style={{marginRight: 40}}>\n      go home\n    </Link>\n    <Link to=\"/login\">To Login</Link>\n  </div>\n);\n\nexport default Header;\n","import React from 'react';\nimport Header from '../../components/Header';\nimport {connect} from 'react-redux';\nimport {getHomeListAction} from './store/actions';\n\nclass Home extends React.Component {\n  componentDidMount() {\n    if (this.props.newList.length === 0) {\n      this.props.getHomeList();\n    }\n  }\n  render() {\n    const {name, newList} = this.props;\n    return (\n      <div>\n        <Header />\n        <h2>Hello {name}, welcome to the lesson for React ssr!</h2>\n        <button onClick={() => alert('you clicked!')}>click me!</button>\n        <ul>\n          {newList.map((news) => (\n            <li key={news.id}>{news.title}</li>\n          ))}\n        </ul>\n      </div>\n    );\n  }\n}\n\nHome.loadData = (store) => {\n  return store.dispatch(getHomeListAction());\n  // console.log('load data');\n};\n\nconst mapStateToProps = (state) => ({\n  name: state.home.name,\n  newList: state.home.newList,\n});\n\nconst mapDispatchToProps = (dispatch) => ({\n  getHomeList: () => dispatch(getHomeListAction()),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Home);\n","import axios from 'axios';\nimport {CHANGE_HOME_LIST} from './constants';\n\nconst changeHomeList = (newList) => ({\n  type: CHANGE_HOME_LIST,\n  newList,\n});\n\nexport const getHomeListAction = () => (dispatch) => {\n  return axios.get('http://localhost:5090/news').then((res) => {\n    if (res.status === 200) {\n      const list = res.data;\n      dispatch(changeHomeList(list));\n    }\n  });\n  // setTimeout(() => {\n  //   console.log('fake data');\n  // }, 1870);\n};\n","export const CHANGE_HOME_LIST = 'home/change_list';\n","import reducer from './reducer';\n\nexport {reducer};\n","import {CHANGE_HOME_LIST} from './constants';\n\nconst defaultState = {\n  name: 'george',\n  newList: [],\n};\n\nexport default (state = defaultState, action) => {\n  switch (action.type) {\n    case CHANGE_HOME_LIST:\n      return {\n        ...state,\n        newList: action.newList,\n      };\n    default:\n      return state;\n  }\n};\n","import React from 'react';\nimport Header from '../../components/Header';\n\nconst Login = () => {\n  return (\n    <div>\n      <Header />\n      Login\n    </div>\n  );\n};\n\nexport default Login;\n","import React from 'react';\n\nimport Home from './containers/Home';\nimport Login from './containers/Login';\n\n// export default (\n//   <div>\n//     <Route path=\"/\" exact component={Home} />\n//     <Route path=\"/login\" exact component={Login} />\n//   </div>\n// );\n\nexport default [\n  {\n    key: 'Home',\n    path: '/',\n    exact: true,\n    component: Home,\n    loadData: Home.loadData,\n  },\n  {\n    key: 'Login',\n    path: '/login',\n    exact: true,\n    component: Login,\n  },\n];\n","import React from 'react';\nimport {renderToString} from 'react-dom/server';\nimport {StaticRouter, Route} from 'react-router-dom';\nimport {Provider} from 'react-redux';\n\nexport const render = (store, routes, path) => {\n  const homeString = renderToString(\n    <Provider store={store}>\n      <StaticRouter location={path} context={{}}>\n        <React.Fragment>\n          {routes.map((route) => (\n            <Route {...route} />\n          ))}\n        </React.Fragment>\n      </StaticRouter>\n    </Provider>\n  );\n\n  return `\n    <html>\n      <head>\n        <title>react ssr</title>\n      </head>\n      <body>\n        <div id=\"root\">${homeString}</div>\n      </body>\n      <script>\n        window.context = {\n          state: ${JSON.stringify(store.getState())}\n        }\n      </script>\n      <script src=\"/index.js\"></script>\n    </html>\n  `;\n};\n","import {createStore, applyMiddleware, combineReducers} from 'redux';\nimport thunk from 'redux-thunk';\nimport {reducer as homeReducer} from '../containers/Home/store';\n\nconst reducer = combineReducers({\n  home: homeReducer,\n});\n\nexport const getStore = () => createStore(reducer, applyMiddleware(thunk));\nexport const getClientStore = () => {\n  const defaultState = window.context.state;\n  return createStore(reducer, defaultState, applyMiddleware(thunk));\n};\n","module.exports = require(\"axios\");;","module.exports = require(\"express\");;","module.exports = require(\"react\");;","module.exports = require(\"react-dom/server\");;","module.exports = require(\"react-redux\");;","module.exports = require(\"react-router-dom\");;","module.exports = require(\"redux\");;","module.exports = require(\"redux-thunk\");;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","import express from 'express';\nimport routes from '../routes';\nimport {matchPath} from 'react-router-dom';\nimport {render} from './utils';\nimport {getStore} from '../store';\n\nconst app = express();\nconst port = 3009;\n\napp.use(express.static('public'));\n\napp.get('*', (req, res) => {\n  const store = getStore();\n\n  const matchedRoutes = [];\n  const promises = [];\n\n  routes.some((route) => {\n    const match = matchPath(req.path, route);\n    if (match) {\n      matchedRoutes.push(route);\n    }\n  });\n  matchedRoutes.forEach((item) => {\n    if (item.loadData) {\n      promises.push(item.loadData(store));\n    }\n  });\n\n  Promise.all(promises).then(() => {\n    const html = render(store, routes, req.path);\n    res.send(html);\n  });\n});\n\napp.listen(port, () => {\n  console.log(`Server is running on http://127.0.0.1:${port}/`);\n});\n"],"sourceRoot":""}